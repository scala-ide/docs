
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN"
  "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">

<html xmlns="http://www.w3.org/1999/xhtml">
  <head>
    <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
    <title>Scala Debugger &#8212; Scala IDE 0.1-SNAPSHOT documentation</title>
    <link rel="stylesheet" href="../../../_static/resources/stylesheets/base.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/pygments.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/resources/stylesheets/bootstrap.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/resources/stylesheets/base.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/resources/stylesheets/doc.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/resources/stylesheets/sphinx.css" type="text/css" />
    <link rel="stylesheet" href="../../../_static/resources/stylesheets/prettify.css" type="text/css" />
    <script type="text/javascript">
      var DOCUMENTATION_OPTIONS = {
        URL_ROOT:    '../../../',
        VERSION:     '0.1-SNAPSHOT',
        COLLAPSE_INDEX: false,
        FILE_SUFFIX: '.html',
        HAS_SOURCE:  true,
        SOURCELINK_SUFFIX: '.txt'
      };
    </script>
    <script type="text/javascript" src="../../../_static/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/underscore.js"></script>
    <script type="text/javascript" src="../../../_static/doctools.js"></script>
    <script type="text/javascript" src="../../../_static/resources/javascript/jquery.js"></script>
    <script type="text/javascript" src="../../../_static/resources/javascript/toc.js"></script>
    <script type="text/javascript" src="../../../_static/resources/javascript/prettify.js"></script>
    <script type="text/javascript" src="../../../_static/resources/javascript/highlightCode.js"></script>
    <script type="text/javascript" src="../../../_static/resources/javascript/effects.core.js"></script>
    <script type="text/javascript" src="../../../_static/resources/javascript/effects.highlight.js"></script>
    <script type="text/javascript" src="../../../_static/resources/javascript/scrollTo.js"></script>
    <script type="text/javascript" src="../../../_static/resources/javascript/bootstrap-dropdown.js"></script>
    <script type="text/javascript" src="../../../_static/resources/javascript/bootstrap-dropdown-app.js"></script>
    <script type="text/javascript" src="../../../_static/resources/javascript/contentsFix.js"></script>
    <link rel="shortcut icon" href="../../../_static/favicon.ico"/>
    <link rel="index" title="Index" href="../../../genindex.html" />
    <link rel="search" title="Search" href="../../../search.html" />
    <link rel="next" title="Asynchronous Debugger new" href="../async-debugger/index.html" />
    <link rel="prev" title="Scala Scopes Building new (since 4.1)" href="../scalacompiler/index.html" /> 
  </head>
  <body>
<div class="top-bar">
  <div class="top-bar-inner">
    <div class="container">
      <a class="brand" href="/index.html"><img src="../../../_static/resources/images/logo.png" height="70px"></a>
      <ul class="nav">
        <li><a href="/index.html#features">Features</a></li>
        <li><a href="/documentation.html">Documentation</a></li>
		<li class="menu">
	      	<a href="#" class="menu">Download</a>
	      	<ul class="menu-dropdown">
	        	<li><a href="/download/sdk.html">Bundle</a></li>
	        	<li><a href="/download/current.html">Stable</a></li>
	        	<li><a href="/download/milestone.html">Milestone</a></li>
	        	<li><a href="/download/nightly.html">Nightlies</a></li>
	      	</ul>
		</li>
        <li><a href="/blog/index.html">News</a></li>
        <li><a href="/team.html">Team</a></li>
      </ul>
    </div>
  </div>
</div>
<div class="slider">
  <div class="container">
    <div class="row">
      <div class="span16">
        <h1>Scala Debugger</h1>
	  </div>
    </div>
  </div>
</div>
<div class="bottom">
  <div class="container" style="position: relative;">

    <div class="row" style="position: relative; clear: both;">
      <div class="span16">
          <ul class="breadcrumb">
            <li><a href="../../../index.html">ScalaIDE Documentation</a> » </li>
              <li><a href="../../index.html">User Documentation for the Scala IDE 4.x - Lithium</a> » </li>
              <li><a href="../../features.html">Features</a> » </li>
          </ul>
      </div>
    </div>

    <div class="row" style="position: relative; clear: both;">
      <div class="span11 main-content">
        <div class="section" id="scala-debugger">
<h1>Scala Debugger</h1>
<div class="section" id="goals">
<h2>Goals</h2>
<p>The idea is to provide a debugger inside Scala IDE more targeted to Scala code.</p>
<p>The main goals are:</p>
<ul class="simple">
<li>Hide the artifacts created by the Scala compiler</li>
<li>Have an intuitive stepping through Scala code</li>
<li>Identify elements as Scala</li>
</ul>
</div>
<div class="section" id="where-to-get-it">
<h2>Where to get it?</h2>
<p>The Scala debugger is a part of Scala IDE and is released as a whole.</p>
</div>
<div class="section" id="using-the-scala-debugger">
<h2>Using the Scala debugger</h2>
<p>The Scala debugger is available as an alternate debug mode launcher for the Scala applications and Equinox Weaving Eclipse applications.</p>
<p>It can be set as the default launcher from the <code class="docutils literal"><span class="pre">Run\Debug</span> <span class="pre">→</span> <span class="pre">Launching</span> <span class="pre">→</span> <span class="pre">Default</span> <span class="pre">Launchers</span></code> preferences:</p>
<img alt="Scala debugger switch" src="../../../_images/preferences-011.png" />
<p>Or it can be selected in each launch configuration:</p>
<img alt="Scala debugger switch" src="../../../_images/preferences-021.png" />
</div>
<div class="section" id="features">
<h2>Features</h2>
<div class="section" id="scala-like-display">
<h3>Scala-like display</h3>
<p>In the different views (debug, variables, <em>and more later</em>), the types and methods are displayed the way they would be written in Scala code.</p>
<img alt="Scala-like display" src="../../../_images/scaladisplay-011.png" />
</div>
<div class="section" id="tostring-display">
<h3>toString display</h3>
<p>In the variables view, the detail pane show the <code class="docutils literal"><span class="pre">toString</span></code> value, or its equivalent, for the currently selected entity.</p>
<img alt="toString in detail pane" src="../../../_images/detailpane-011.png" />
</div>
<div class="section" id="logical-structures-support">
<span id="id1"></span><h3>Logical structures support</h3>
<p>By default, the variables view shows the internals of each entity.</p>
<img alt="logical structure disabled" src="../../../_images/logicalstructure-011.png" />
<p>But in a lot of cases, it is not the sought after information. Using the <code class="docutils literal"><span class="pre">Show</span> <span class="pre">Logical</span> <span class="pre">Structure</span></code> toolbar button, the data is shown is a more synthetic way.</p>
<img alt="logical structure enabled" src="../../../_images/logicalstructure-021.png" />
<p><em>In the preview version, only support for List has been tested</em></p>
</div>
<div class="section" id="smart-stepping">
<h3>Smart stepping</h3>
<p>A normal Java debugger is made to debug applications written in Java. It cannot handle concept like closures.</p>
<p>In a situation like the following, it would jump the full <code class="docutils literal"><span class="pre">map</span></code> call when asked to do a ‘step over’.</p>
<img alt="smart stepping - initial state" src="../../../_images/smartstepping-011.png" />
<p>The Scala debugger is able to find those and stop inside the closure. The closure variables are visible.</p>
<img alt="smart stepping - initial state" src="../../../_images/smartstepping-021.png" />
<p>After an other ‘step over’, the debugger stops at the evaluation of the closure for the second element.</p>
<img alt="smart stepping - initial state" src="../../../_images/smartstepping-031.png" />
<p>At the next ‘step over’, the debugger exits the map call, and stop at the assignment. After an extra ‘step over’, the result is visible in <code class="docutils literal"><span class="pre">k</span></code>.</p>
<img alt="smart stepping - initial state" src="../../../_images/smartstepping-041.png" />
<p>The same way, the ‘step into’ action allows you to step right into the closure, and the ‘step out’ action to return to the original call.</p>
<p><em>In the preview version, ‘step into’ is not working fine with primitive types</em></p>
</div>
<div class="section" id="step-filters">
<h3>Step filters</h3>
<p>Often when stepping in and out of Scala methods you don’t want to stop in all the artifacts produced by the Scala compiler. Those includes:</p>
<ul class="simple">
<li>synthetic methods</li>
<li>Scala getters for <code class="docutils literal"><span class="pre">val</span></code> members</li>
<li>Scala getters and setters for <code class="docutils literal"><span class="pre">var</span></code> members</li>
<li>getters for default argument (ending in <code class="docutils literal"><span class="pre">$default$1,2,..</span></code>)</li>
<li>forwarders for concrete trait methods</li>
</ul>
<p>You can enable/disable step filters on the debugger configuration page:</p>
<img alt="step filters configuration" src="../../../_images/step-filters.png" />
</div>
<div class="section" id="boxed-primitive-values">
<h3>Boxed primitive values</h3>
<p>The value of boxed primitives is extracted to be displayed.</p>
<img alt="showing value of boxed primitives" src="../../../_images/unboxedprimitive-011.png" />
</div>
<div class="section" id="clean-stack-frame-list">
<h3>Clean stack frame list</h3>
<p>Smart stepping ‘hides’ the internal details of collections and closure. This information is also hidden in the debug view, only the relevant stack frames are displayed.</p>
</div>
<div class="section" id="remote-debugging">
<h3>Remote Debugging</h3>
<p>Using the Scala debugger for a remote debugging session is done by selecting one of the Scala connector in a normal ‘Remote Java Application’ launch configuration. The remainder of the configuration is the same as for Java remote debugging.</p>
<img alt="Scala remote debugging configuration" src="../../../_images/remotedebugging-011.png" />
</div>
<div class="section" id="drop-to-frame-new-since-4-0">
<h3>Drop to frame <span class="raw-html"><span class="label info">new</span></span> (since 4.0)</h3>
<p>Select the <code class="docutils literal"><span class="pre">Drop</span> <span class="pre">to</span> <span class="pre">Frame</span></code> command to re-enter the selected stack frame in the <code class="docutils literal"><span class="pre">Debug</span></code> View.</p>
<img alt="drop to frame option in menu" src="../../../_images/drop-to-frame.png" />
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">This command is only available if the current VM supports dropping frames and the stack frames between the
one below selected stack frame and the top one are not in a native method.</p>
</div>
</div>
</div>
<div class="section" id="hot-code-replace-new-since-4-1">
<h2>Hot code replace <span class="raw-html"><span class="label info">new</span></span> (since 4.1)</h2>
<p>Hot code replace adds the possibility to modify and re-compile code in a debug mode and to have these changes visible
and taken into account by the debugged VM without restarting the application.</p>
<div class="admonition note">
<p class="first admonition-title">Note</p>
<p class="last">HCR is limited by JVM’s support for replacing classes. Its goal is to allow to experiment with the code
inside methods/blocks rather than to develop the whole application in the interactive mode. Changes of methods’
signatures etc. do not work - similarly to other HCR implementations in Eclipse or other IDEs.</p>
</div>
<div class="section" id="configuration">
<h3>Configuration</h3>
<div class="admonition warning">
<p class="first admonition-title">Warning</p>
<p>This feature is turned off by default and can be turned on in preferences.
The reason is that it’s the initial implementation. It may be very helpful, but there are also known issues:</p>
<ul class="simple">
<li>JVM doesn’t like obsolete frames. Therefore, there are situations when it may crash after HCR.</li>
<li>Automatic dropping frames may not work when running two or more HCRs one after another without going further with the
execution (resume and hit another breakpoint, step into etc.).</li>
</ul>
<p class="last">These problems should disappear in the future after adding to HCR the missing feature which we are aware of.</p>
</div>
<p>Multiple parameters of HCR can be configured in menu:</p>
<a class="reference internal image-reference" href="../../../_images/hot-code-replace.png"><img alt="hot code replace configuration menu" src="../../../_images/hot-code-replace.png" style="width: 100%;" /></a>
<p>Those allows to:</p>
<ul class="simple">
<li>enable or disable HCR,</li>
<li>configure whether error messages from HCR should be shown,</li>
<li>change whether files containing compilation errors should be skipped,</li>
<li>automatically drop (or not) obsolete frames on suspended threads,</li>
<li>and ignore obsolete state of frames when performing drop to frame (in other words, allow to drop obsolete frames manually).
This one may be needed only if you disable automatic drop to frame after HCR.</li>
</ul>
</div>
</div>
<div class="section" id="expression-evaluator-new-since-4-1">
<h2>Expression evaluator <span class="raw-html"><span class="label info">new</span></span> (since 4.1)</h2>
<p>Scala debugger since 4.1 features new expression evaluator, which translates user code into invocations of <code class="docutils literal"><span class="pre">JDI</span></code> remote
calls. This allows evaluation of expression in context of breakpoint, with access to local variables and methods.</p>
<p>For more detailed documentation, with examples and limitations see <a class="reference internal" href="../../../current-user-doc/features/scaladebugger/expression-evaluator.html#expression-evaluator-user-docs"><span class="std std-ref">Expression evaluator user documentation</span></a>.</p>
</div>
<div class="section" id="further-improvements-and-unsupported-features">
<h2>Further improvements and unsupported features</h2>
<p><em>may not be exhaustive, not really ordered, updated 2015-04-27</em></p>
<ul class="simple">
<li>Take care of breakpoints in Scala Debugger, currently still done by JDT debugger</li>
<li>Use own jdi event dispatcher, instead of using the JDT debugger one</li>
<li>Set the right icon according to the element type and state</li>
<li>Improve the labels<ul>
<li><em>Running</em>, <em>Suspended</em>, <em>Terminated</em> suffix on debug target and thread</li>
<li>option to display simple or fully qualified types</li>
<li>clean way to display object name, without the <code class="docutils literal"><span class="pre">$</span></code></li>
</ul>
</li>
<li>filtered stack frames option<ul>
<li>to hide some Scala internals, like collections</li>
<li>configurable list in preferences</li>
</ul>
</li>
<li>filter synthetic elements in the variable view</li>
<li>extension point for additional support of logical structures</li>
<li>use IIndexedValue for arrays</li>
<li>better smart step into support<ul>
<li>collection of primitive type elements</li>
</ul>
</li>
<li>step over and step out relative to the currently selected stackframe</li>
<li>cache data used for smart stepping<ul>
<li>result of findAnonFunction</li>
<li>keep enabled ClassPreparedRequests to avoid requesting <em>allClasses</em> every time</li>
</ul>
</li>
<li>better Scala breakpoints<ul>
<li>may still need to be based on Java breakpoints</li>
<li>smarter <em>add breakpoint</em></li>
<li>method breakpoint support</li>
<li>watchpoint support</li>
</ul>
</li>
<li>display the value returned by the last executed method (a proof of concept is working. Need to define the exact behavior and devise a way to present the value)</li>
</ul>
</div>
<div class="section" id="development-setup">
<h2>Development setup</h2>
<p>The Scala debugger adds 4 new plugins, 2 for debugger: <code class="docutils literal"><span class="pre">org.scala-ide.sdt.debug</span></code>, <code class="docutils literal"><span class="pre">org.scala-ide.sdt.debug.tests</span></code> and 2 for expression evaluator: <code class="docutils literal"><span class="pre">org.scala-ide.sdt.debug.expression</span></code>, <code class="docutils literal"><span class="pre">org.scala-ide.sdt.debug.expression.tests</span></code></p>
<div class="section" id="in-eclipse">
<h3>In Eclipse</h3>
<p>The Scala debugger makes use of the <a class="reference external" href="http://docs.oracle.com/javase/6/docs/jdk/api/jpda/jdi/index.html">JDI</a> to communicate with the VM. For some valid reasons, the jdt.debug plug-in provides a non-generic version of it. The Scala debugger uses the newer generic version, so some tweaking is needed inside Eclipse.</p>
<div class="section" id="on-mac-os-x">
<h4>On Mac OS X</h4>
<p>The generic version of the JDI is included by default in the VM libraries, just remove the <code class="docutils literal"><span class="pre">JAVA_HOME/lib/tools.jar</span></code> entry from the Java build path to have the project to compile.</p>
</div>
<div class="section" id="on-the-other-oses">
<h4>On the other OSes</h4>
<p>On non-Mac OS X systems, JDI is not part of the VM default libraries. To steps are needed to have the project to compile correctly:</p>
<ul class="simple">
<li>create a <code class="docutils literal"><span class="pre">Classpath</span> <span class="pre">Variable</span></code> in <code class="docutils literal"><span class="pre">Window</span> <span class="pre">→</span> <span class="pre">Preferences</span> <span class="pre">→</span> <span class="pre">Java</span> <span class="pre">→</span> <span class="pre">Build</span> <span class="pre">Path</span> <span class="pre">→</span> <span class="pre">Classpath</span> <span class="pre">Variables</span></code> named <code class="docutils literal"><span class="pre">JAVA_HOME</span></code>, which points to the root folder of your JDK installation.</li>
<li>in <code class="docutils literal"><span class="pre">Window</span> <span class="pre">→</span> <span class="pre">Preferences</span> <span class="pre">→</span> <span class="pre">Java</span> <span class="pre">→</span> <span class="pre">Installed</span> <span class="pre">JREs</span></code>, edit your JDK, and use <code class="docutils literal"><span class="pre">Add</span> <span class="pre">External</span> <span class="pre">JARs</span></code> to add the <code class="docutils literal"><span class="pre">JDK_HOME/lib/tools.jar</span></code> library.</li>
</ul>
</div>
</div>
</div>
</div>

	    </div>
      <div class="span5 sidebar">
        <p class="contents-title">Contents</p>
        <div id="scroller-anchor">
          <div id="scroller">
            <div id="toc"></div>
          </div>
        </div>
	    </div>
    </div>

  </div>
</div>
<div class="footer" style="position:relative; clear: both; ">
  <div class="container">
    <ul>
      <li><h5>Download</h5></li>
      <li><a href="/download/sdk.html">Bundle</a></li>
      <li><a href="/download/current.html">Stable</a></li>
      <li><a href="/download/milestone.html">Milestone</a></li>
      <li><a href="/download/nightly.html">Nightlies</a></li>
    </ul>
    <ul>
      <li><h5>Documentation</h5></li>
      <li><a href="/docs/user/gettingstarted.html">Getting Started</a></li>
      <li><a href="/docs/videos.html">Videos</a></li>
      <li><a href="/docs/tutorials/index.html">Tutorials</a></li>
      <li><a href="http://groups.google.com/group/scala-ide-user">User Mailing List</a></li>
    </ul>
    <ul>
      <li><h5>Contribute</h5></li>
      <li><a href="https://github.com/scala-ide/scala-ide">Source Code</a></li>
      <li><a href="/docs/dev/index.html">Developer Documentation</a></li>
      <li><a href="http://groups.google.com/group/scala-ide-dev">Developer Mailing List</a></li>
      <li><a href="http://scala-ide-portfolio.assembla.com/spaces/scala-ide/support/tickets">Report a Bug</a></li>
      <li><a href="http://www.typesafe.com/contribute/cla">Individual CLA</a></li>
      <li><a href="/resources/pdfs/cla-org.pdf">Organization CLA</a></li>
    </ul>
    <ul>
      <li><img src="../../../_static/resources/images/watermark.png" align="center"/></li>
    </ul>
  </div>
  <div class="container copyright">
    <p>
      <a href="http://creativecommons.org/licenses/by/2.0/uk/">Creative Commons</a>
	  <a href="http://scala-ide.org/feed.rss"><img align="right" height="20px" width="20px" src="http://scala-ide.org/resources/images/rss.png" alt="RSS feed of updates to the Scala IDE blog"></a>
    </p>
  </div>
</div>
<script type="text/javascript">
  $('#toc').toc();
</script>
<script type="text/javascript">

  var _gaq = _gaq || [];
  _gaq.push(['_setAccount', 'UA-574683-7']);
  _gaq.push(['_trackPageview']);

  (function() {
    var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
    ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
    var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
  })();

  function startVideo(div_id, youtube_id) {
    var video = '<iframe class="doc_video" src="http://www.youtube.com/embed/' + youtube_id + '?rel=0&autoplay=1&vq=hd720" frameborder="0" allowfullscreen></iframe>';
    document.getElementById(div_id).innerHTML = video
  }


</script>

  </body>
</html>